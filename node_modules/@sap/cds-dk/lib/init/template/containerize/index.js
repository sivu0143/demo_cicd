const cds = require('../../../cds')
const { exists, rimraf } = cds.utils
const { readProject } = require('../../projectReader');
const { merge } = require('../../merge')

module.exports = class ContainerizeTemplate extends require('../../plugin') {

    static help() {
        return 'containerization using ctz CLI'
    }

    static hasInProduction () {
        return exists('containerize.yaml')
    }

    async run() {
        if (cds.cli.options.force) {
            await rimraf('containerize.yaml')
        }

        const project = readProject()
        await merge(__dirname, '/files/containerize.yaml.hbs').into('containerize.yaml', { with: project })
    }
}
