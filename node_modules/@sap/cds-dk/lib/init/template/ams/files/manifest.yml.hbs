---
applications:
  - name: {{appName}}-srv
    env:
      AMS_DCL_ROOT: ams/dcl

  - name: {{appName}}-ams-policies-deployer
    {{#isJava}}
    path: srv/src/gen/policies
    {{/isJava}}
    {{^isJava}}
    path: gen/policies
    {{/isJava}}
    no-route: true
    health-check-type: none
    memory: 256M
    instances: 1
    buildpack: nodejs_buildpack
    command: (npm start && echo "This application may now be stopped to free resources." || echo "AMS Policy Deployment unsuccessful.") && sleep infinity
    services:
      - name: {{appName}}-ias
        parameters:
          credential-type: X509_GENERATED
          app-identifier: ams-policy-deployer
