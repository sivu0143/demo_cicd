const semver = exports = module.exports = (x,y,z) => {
  if (typeof x === 'string') [ x,y,z ] = String(x).split('.')
  return 1e6 * (x||0) + 1e3 * (y||0) + +(z||0)
}

exports.checkNodeVersion = (cds = require ('../../package.json')) => {
  let required = cds.engines?.node?.slice(2) //> e.g. >=22
  let current = process.version.slice(1)    //> e.g. v24.4.1
  if (semver(current) >= semver(required)) return; else process.stderr.write (`
    Node.js version ${required} or higher is required for @sap/cds v${cds.version}.
    Current version ${current} does not satisfy this. \n\n`)
  return process.exit(1)
}

exports.check = (x, min, max) => {
  let v = semver(x)
  return (!min || semver(min) <= v) && (!max || v <= semver(max))
}
